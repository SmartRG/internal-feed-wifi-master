From 11e911d70ba2719a769ee09bb65cba91173e3b6b Mon Sep 17 00:00:00 2001
From: Chad Monroe <chad.monroe@smartrg.com>
Date: Wed, 8 Dec 2021 16:29:36 -0800
Subject: [PATCH] Revert "mt76: mt7915: improve wmm index allocation"

This reverts commit 1911486414dcdb58374fb947197a0871b4cb450d.
---
 mt7915/main.c | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/mt7915/main.c b/mt7915/main.c
index 31fceeed..2179ea85 100644
--- a/mt7915/main.c
+++ b/mt7915/main.c
@@ -218,9 +218,11 @@ static int mt7915_add_interface(struct ieee80211_hw *hw,
 	mvif->phy = phy;
 	mvif->band_idx = ext_phy;
 
-	mvif->wmm_idx = vif->type != NL80211_IFTYPE_AP;
-	if (ext_phy)
-		mvif->wmm_idx += 2;
+	if (dev->mt76.phy2)
+		mvif->wmm_idx = ext_phy * (MT7915_MAX_WMM_SETS / 2) +
+				mvif->idx % (MT7915_MAX_WMM_SETS / 2);
+	else
+		mvif->wmm_idx = mvif->idx % MT7915_MAX_WMM_SETS;
 
 	ret = mt7915_mcu_add_dev_info(phy, vif, true);
 	if (ret)
-- 
2.33.1

